{"content":{"type":"API","structure":"","server_on_load":"async ({\n  template,\n  params,\n  render,\n  db,\n  req,\n  reply,\n  user,\n  log,\n  ext,\n  isDev,\n}: Server) => {\n  const privateKey = \"Team 6 Andromedia\";\n  let a_post = {\n    email: req.body.email,\n    pass: req.body.password,\n  };\n  const dataLogin = db.muser.findUnique({\n    where: {\n      email: a_post.email,\n    },\n  });\n  dataLogin.then((e) => {\n    if (e != null) {\n      if (\n        a_post.pass ==\n        ext.CryptoJS.AES.decrypt(e.password, privateKey).toString(\n          ext.CryptoJS.enc.Utf8\n        )\n      ) {\n        let token_private = ext.CryptoJS.SHA3(privateKey, {\n          outputLength: 512,\n        }).toString();\n        let in_data =\n          e.id + \";\" + token_private + \";\" + e.email + \";\" + ext.address.ip();\n        let id_user = ext.CryptoJS.AES.encrypt(in_data, privateKey).toString();\n        user.id = id_user;\n        reply.send({\n          status: true,\n          ip: in_data,\n          iduser: id_user,\n          session: user.id,\n        });\n      } else {\n        reply.send({\n          status: false,\n          msg: \"password invalid\",\n        });\n      }\n    } else {\n      reply.send({\n        status: false,\n        msg: \"data not found\",\n      });\n    }\n\n    // if (\n    //   typeof req.body.password !== \"undefined\" &&\n    //   req.body.password != null\n    // ) {\n    //   let pass = ext.CryptoJS.AES.decrypt(\n    //     req.body.password,\n    //     privateKey\n    //   ).toString();\n    //   let status = false;\n    //   let in_data = {};\n    //   if (pass == mail.password) {\n    //     status = true;\n    //     in_data = mail.id + \";\" + \"token\" + \";\" + mail.email;\n    //     in_data = ext.CryptoJS.AES.encrypt(in_data, privateKey).toString();\n    //     req.session.id = in_data;\n    //   }\n    //   reply.send({\n    //     status: status,\n    //     data: in_data,\n    //     data_masuk: a_post,\n    //     token: ext.CryptoJS.SHA3(\"Message\", { outputLength: 512 }),\n    //   });\n    // } else {\n    //   reply.send({\n    //     ip: \"password invalid\",\n    //   });\n    // }\n    // reply.send({\n    //   ip: mail,\n    // });\n  });\n  // .catch((e) => {\n  //   reply.send({\n  //     msg: \"email not found\",\n  //   });\n  // });\n  // dataLogin.then((e) => {\n  //   let password = ext.CryptoJS.AES.decrypt(e.password, privateKey).toString(\n  //     ext.CryptoJS.enc.Utf8\n  //   );\n  //   // let value = 'wow';\n  //   // if (typeof(value) !== 'undefined' && value != null) {\n  //   //   console.log('Not Undefined and Not Null');\n  //   // } else {\n  //   //   console.log('Undefined or Null');\n  //   // }\n  //   // CryptoJS.SHA3(\"Message\", { outputLength: 512 });\n  //   // address.ip();   // '192.168.0.2'\n  //   // address.ipv6(); // 'fe80::7aca:39ff:feb0:e67d'\n  //   // local loopback\n  //   // address.ip('lo'); // '127.0.0.1'\n  //   // address.dns(function (err, addrs) {\n  //   //   console.log(addrs);\n  //   //   // ['10.13.2.1', '10.13.2.6']\n  //   // });\n  //   // address(function (err, addrs) {\n  //   //   console.log(addrs.ip, addrs.ipv6, addrs.mac);\n  //   //   // '192.168.0.2', 'fe80::7aca:39ff:feb0:e67d', '78:ca:39:b0:e6:7d'\n  //   // });\n\n  //   // address('vboxnet', function (err, addrs) {\n  //   //   console.log(addrs.ip, addrs.ipv6, addrs.mac);\n  //   //   // '192.168.56.1', null, '0a:00:27:00:00:00'\n  //   // });\n\n  //   let status = false;\n  //   let in_data = {};\n  //   if (password == a_pass) {\n  //     status = true;\n  //     in_data = e.id + \";\" + \"token\" + \";\" + e.email;\n  //     in_data = ext.CryptoJS.AES.encrypt(in_data, privateKey).toString();\n  //     req.session.id = in_data;\n  //   }\n  //   reply.send({\n  //     status: status,\n  //     data: in_data,\n  //     data_masuk: a_post,\n  //     token: ext.CryptoJS.SHA3(\"Message\", { outputLength: 512 }),\n  //   });\n  // })\n}","figma":{}},"title":"login","type":"cms-template","lang":"","status":"SYSTEM","parent_id":"54643","slug":"/api/login","site":"*","id":"46513"}